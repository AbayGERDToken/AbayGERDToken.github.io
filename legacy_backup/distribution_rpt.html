<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Token Distribution Report</title>
  
  <!-- Bootstrap 5.3.3 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  
  <!-- Google Fonts - Outfit -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/main.css"/>
  
  <!-- Firebase + Web3 -->
  <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  
  <style>
    :root {
      --gerd-primary: #198754;
      --gerd-dark: #0f5132;
      --gerd-light: #d1e7dd;
    }
    
    .hero-section {
      background: linear-gradient(135deg, var(--gerd-primary) 0%, var(--gerd-dark) 100%);
      color: white;
      padding: 60px 0;
      position: relative;
      overflow: hidden;
    }
    
    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse"><path d="M 100 0 L 0 0 0 100" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      opacity: 0.3;
    }
    
    .hero-content {
      position: relative;
      z-index: 1;
    }
    
    .feature-card {
      border: none;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.15);
    }
    
    .content-section {
      padding: 80px 0;
    }
    
    #summary-table {
      border-radius: 12px;
      overflow: hidden;
    }
    
    #summary-table th {
      background-color: #198754;
      color: white;
      font-weight: 600;
      padding: 16px;
    }
    
    #summary-table td {
      padding: 14px 16px;
    }
    
    .stat-box {
      background: linear-gradient(135deg, var(--gerd-light) 0%, white 100%);
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      border: 2px solid var(--gerd-light);
    }
  </style>
</head>

<body>
  <!-- Dynamic Navbar -->
  <div id="navbar-container"></div>
  <script>
    fetch('navtest.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('navbar-container').innerHTML = html;
      })
      .catch(err => console.error('Error loading navbar:', err));
  </script>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="container">
      <div class="hero-content">
        <div class="row">
          <div class="col-lg-10 mx-auto text-center">
            <h1 class="display-4 fw-bold mb-4"><i class="fas fa-chart-bar me-3"></i>Distribution Statistics</h1>
            <p class="lead fs-5 opacity-90">Total tokens claimed by Country - Real-time global distribution data</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Statistics Section -->
  <section class="content-section">
    <div class="container">
      <div class="row mb-5">
        <div class="col-lg-8 mx-auto text-center">
          <button class="btn btn-success btn-lg mb-3" id="show-summary">
            <i class="fas fa-sync-alt me-2"></i>Refresh Data
          </button>
          <p class="text-muted small">*Click button to pull updated data from the blockchain.</p>
        </div>
      </div>

      <div class="row g-4 mb-5" id="stats-container" style="display: none;">
        <div class="col-md-6">
          <div class="stat-box">
            <div class="display-6 fw-bold text-primary mb-2" id="total-claims-display">-</div>
            <p class="text-muted mb-0">Total Claims</p>
          </div>
        </div>
        <div class="col-md-6">
          <div class="stat-box">
            <div class="display-6 fw-bold text-success mb-2" id="total-tokens-display">-</div>
            <p class="text-muted mb-0">Total Tokens Claimed</p>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-lg-10 mx-auto">
          <div class="card feature-card">
            <div class="card-body p-4">
              <h2 class="h4 fw-bold mb-4 text-center"><i class="fas fa-table me-2"></i>Distribution by Country</h2>
              <div class="table-responsive">
                <table id="summary-table" class="table table-striped table-hover mb-0">
                  <thead>
                    <tr>
                      <th>Country Name</th>
                      <th>Number of Claims</th>
                      <th>Total Tokens Claimed</th>
                    </tr>
                  </thead>
                  <tbody id="summary-table-body">
                    <tr>
                      <td colspan="3" class="text-center py-5">
                        <i class="fas fa-spinner fa-spin fa-2x text-muted mb-3 d-block"></i>
                        <p class="text-muted mb-0">Click "Refresh Data" to load distribution statistics</p>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="mt-4 pt-3 border-top">
                <p id="total-claims" class="fw-bold mb-2"></p>
                <p id="total-tokens" class="fw-bold mb-0"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Tableau Visualization Section -->
  <section class="content-section bg-light">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="card feature-card">
            <div class="card-body p-4">
              <h2 class="h4 fw-bold mb-4 text-center"><i class="fas fa-chart-line me-2"></i>Interactive Distribution Dashboard</h2>
              <div class='tableauPlaceholder' id='viz1686619041159' style='position: relative; min-height: 600px;'>
                <noscript><a href='#'><img alt='Dashboard 1 ' src='https://public.tableau.com/static/images/Di/Distribution_Tableau/Dashboard1/1_rss.png' style='border: none' /></a></noscript>
                <object class='tableauViz' style='display:none;'>
                  <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                  <param name='embed_code_version' value='3' />
                  <param name='site_root' value='' />
                  <param name='name' value='Distribution_Tableau/Dashboard1' />
                  <param name='tabs' value='no' />
                  <param name='toolbar' value='yes' />
                  <param name='static_image' value='https://public.tableau.com/static/images/Di/Distribution_Tableau/Dashboard1/1.png' />
                  <param name='animate_transition' value='yes' />
                  <param name='display_static_image' value='yes' />
                  <param name='display_spinner' value='yes' />
                  <param name='display_overlay' value='yes' />
                  <param name='display_count' value='yes' />
                  <param name='language' value='en-US' />
                </object>
              </div>
              <script type='text/javascript'>
                var divElement = document.getElementById('viz1686619041159');
                var vizElement = divElement.getElementsByTagName('object')[0];
                if (divElement.offsetWidth > 800) {
                  vizElement.style.width = '1000px';
                  vizElement.style.height = '827px';
                } else if (divElement.offsetWidth > 500) {
                  vizElement.style.width = '1000px';
                  vizElement.style.height = '827px';
                } else {
                  vizElement.style.width = '100%';
                  vizElement.style.height = '927px';
                }
                var scriptElement = document.createElement('script');
                scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
                vizElement.parentNode.insertBefore(scriptElement, vizElement);
              </script>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="bg-success-subtle py-5 mb-0">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h2 class="h5 mb-3">
            DISCOVER ABAY GERD TOKEN, THE ETHIOPIAN-BORN CRYPTOCURRENCY EMPOWERING OUR COMMUNITY.
            JOIN US IN CREATING A BRIGHTER FUTURE! #ABAYGERDTOKEN #ETHIOPIA #CRYPTO #GERD
          </h2>
        </div>
        <div class="col-md-4 text-center">
          <img src="image/abay_bluesky.png" alt="AbayGERDToken" class="img-fluid img-hero">
        </div>
      </div>
    </div>
  </section>

  <footer class="bg-dark text-light py-4">
    <div class="container text-center">
      <p class="small mb-0">
        Copyright 2023 Abay GERD Token. All rights reserved.
      </p>
    </div>
  </footer>

  <!-- Your custom report JS -->
  <script src="js/send-gerd.js"></script>
  
  <!-- Bootstrap 5.3.3 JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    // Update stats display when data is loaded
    const originalUpdateStats = window.updateStats;
    if (typeof originalUpdateStats === 'undefined') {
      // If send-gerd.js hasn't loaded yet, wait for it
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() {
          const totalClaimsEl = document.getElementById('total-claims');
          const totalTokensEl = document.getElementById('total-tokens');
          if (totalClaimsEl && totalClaimsEl.textContent) {
            document.getElementById('stats-container').style.display = 'block';
            document.getElementById('total-claims-display').textContent = totalClaimsEl.textContent.replace(/[^\d,]/g, '');
            document.getElementById('total-tokens-display').textContent = totalTokensEl.textContent.replace(/[^\d,]/g, '');
          }
        }, 1000);
      });
    }
  </script>
</body>
</html>

